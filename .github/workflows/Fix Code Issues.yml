name: Fix Code Issues

on: [push]

jobs:
  pylint_and_fix:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: ["3.9", "3.10", "3.11"]
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v2
      with:
        python-version: ${{ matrix.python-version }}
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pylint autopep8  # Installing autopep8 for fixing issues
        
    - name: Analysing the code with pylint
      run: |
        ##files=$(find . -type f \( -name "*.py" -o -name "*.pyw" \))
        pylint *.py ##--evaluation=bad-names,unused-variable,unused-argument,unused-import,missing-module-docstring,missing-function-docstring,missing-class-docstring,missing-final-newline,multiple-imports,trailing-whitespace
        
    - name: Fixing code issues
      run: |
        autopep8 --in-place --recursive .
        
    - name: Commit changes
      run: |
        git config --global user.email "you@example.com"
        git config --global user.name "Your Name"
        git add .
        git commit -m "Automatically fix pylint issues"
        
    - name: Push changes
      uses: ad-m/github-push-action@master
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}

    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v3
      with:
        title: "Automatically fix pylint issues"
        branch: "fix-pylint-issues"
        body: |
          This PR was automatically generated to fix pylint issues.
